# Generated by Chef for ip-10-5-44-41.ec2.internal
# Local modifications will be overwritten.

# This file generated from a Chef template.
# squid/templates/default/squid.conf.erb

debug_options 28,7

###
### Global settings define
###

http_port 3128

###
### Authorization rules define
###

###
### Networks define
###

acl localnet src 10.5.0.0/1
acl localnet src 172.16.0.0/16
acl localnet src fc00::/7
acl localnet src fe80::/10

###
### Ports define
###

acl SSL_ports port 443          # https
acl SSL_ports port 22           # SSH
acl Safe_ports port 80          # http
acl Safe_ports port 443         # https
acl Safe_ports port 22          # SSH

acl purge method PURGE

acl CONNECT method CONNECT


# Managed with Chef
acl bastion src 10.5.0.0/1
acl whitelist url_regex "/vagrant/squid_sites.txt"

###
### Rules define
###

http_access allow manager localhost
http_access deny manager
http_access deny !Safe_ports
http_access allow localhost
http_access allow purge localhost
http_access deny purge
http_access deny CONNECT !SSL_ports

http_access allow bastion whitelist
http_access deny bastion all

# http_access deny all

###
### Secondary global settings define
###


# icp_access allow localnet
# icp_access deny all
#
# htcp_access allow localnet
# htcp_access deny all

# Add any of your own refresh_pattern entries above these.
access_log /var/log/squid3/access.log squid
cache_log /var/log/squid3/cache.log squid
cache_store_log /var/log/squid3/store.log squid

refresh_pattern      ^ftp:      1440  20%  10080
refresh_pattern     ^gopher:      1440  0%  1440
refresh_pattern      -i (/cgi-bin/|\?)    0  0%  0
refresh_pattern     (Release|Package(.gz)*)$  0  20%  2880


coredump_dir /var/spool/squid3
maximum_object_size 1024 MB
cache_mem 2048 MB
